<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <title>Perfil</title>
</head>

<body>
    <header>
        <h1>Home</h1>
        <nav>
            <a href="encontreiAnimal.html">Encontrei um Animal</a>
            <a href="queroAjudar.html">Quero Ajudar</a>
            <a href="sobreNos.html">Sobre nós</a>
            <a href="sobreONG.html">Sobre a ONG</a>
        </nav>
    </header>

    <main>
        <class class="container">

            <div class="row fill_green_perfil">
                <div class="row div-titulo">
                    <h3 class="titulo">Perfil</h3>
                </div>
                <div class="row fill_green_cadastro">
                    <form id="form-contato">
                        <div class="form-group row align-items-center mb-3">
                            <div class="col-sm-3 text-center file-input-container">
                                <label for="inputImagem">
                                    <img src="https://as2.ftcdn.net/v2/jpg/03/49/49/79/1000_F_349497933_Ly4im8BDmHLaLzgyKg2f2yZOvJjBtlw5.jpg"
                                        alt="imagemPerfil" class="img-thumbnail perfil-img" id="imagemPerfil">
                                </label>
                                <input type="text" class="form-control mt-2" id="inputImagem" placeholder="Informe o url">
                            </div>
                            <div class="col-sm-9">
                                <div class="form-group row align-items-center mb-3">
                                    <label for="inputNome" class="label-box col-sm-2">Nome:</label>
                                    <div class="col-sm-9">
                                        <input type="text" class="form-control" id="inputNome" required
                                            placeholder="Informe o nome">
                                    </div>
                                </div>
                                <div class="form-group row align-items-center mb-3">
                                    <label for="inputEmail" class="label-box col-sm-2">E-mail:</label>
                                    <div class="col-sm-9">
                                        <input type="email" class="form-control" id="inputEmail" required
                                            placeholder="Informe o e-mail">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row align-items-center mb-3">
                                <label for="inputSenha" class="label-box col-sm-2">Senha:</label>
                                <div class="col-sm-8">
                                    <input type="password" class="form-control" id="inputSenha" required
                                        placeholder="Informe sua senha">
                                </div>
                            </div>
                            <div class="form-group row align-items-center mb-3">
                                <label for="inputConfirma" class="label-box col-sm-2">Confirme:</label>
                                <div class="col-sm-8">
                                    <input type="password" class="form-control" id="inputConfirma" required
                                        placeholder="Confirme sua senha">
                                </div>
                            </div>
                        </div>

                        <div class="form-group row align-items-center mb-2">
                            <label  class="label-box col-sm-2">Tags:</label>
                        </div>

                        <div class="form-group row align-items-center mb-2">
                            <div class="col-sm-6">
                                <div class="form-group row align-items-center mb-3">
                                    <div class="col-sm-10">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="Animado"
                                                id="checkboxEnergetico">
                                            <label class="form-check-label" for="checkboxEnergetico">
                                                Animado
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="Pratica atividades físicas"
                                                id="checkboxCarente">
                                            <label class="form-check-label" for="checkboxCarente">
                                                Pratica atividades físicas
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="Extrovertido"
                                                id="checkboxOcupado">
                                            <label class="form-check-label" for="checkboxOcupado">
                                                Extrovertido
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group row align-items-center mb-3">
                                    <div class="col-sm-12">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="Calmo"
                                                id="checkboxTranquilo">
                                            <label class="form-check-label" for="checkboxTranquilo">
                                                Calmo
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="Caseiro"
                                                id="checkboxAventureiro">
                                            <label class="form-check-label" for="checkboxAventureiro">
                                                Caseiro
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="Introvertido"
                                                id="checkboxSociavel">
                                            <label class="form-check-label" for="checkboxSociavel">
                                                Introvertido
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>



                    </form>
                </div>
                <div class="form-group row align-items-center">
                    <div class="col-sm-12 text-center">
                        <input type="button" class="btn btn-warning" id="btnUpdate" value="Alterar">
                    </div>
                    <div class="col-sm-12 text-center">
                        <input type="button" class="btn btn-warning" id="btnClear" value="Deletar">
                    </div>
                </div>
            </div>
            <div id="msg"> </div>
        </class>
    </main>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="scripts/app.js"></script>
    <script>
        $(document).ready(function () {
            localStorage.setItem('id', '85'); //modifique aqui o id
            var id = localStorage.getItem('id');
            init(id);
            loadProfileData(id);
        });

        function init(id) {
            // Adiciona funções para tratar os eventos 
            $("#btnUpdate").click(function () {
                if (!$('#form-contato')[0].checkValidity()) {
                    displayMessage("Preencha o perfil com novas informações.");
                    return;
                }

                let senha = $("#inputSenha").val();
                let confirma = $("#inputConfirma").val();
                let nome = $("#inputNome").val();
                let email = $("#inputEmail").val();
                let imagem = $("#inputImagem").val();

                if (senha !== confirma) {
                    displayMessage("As senhas não coincidem. Por favor, tente novamente.");
                    return;
                }

                let cadastro = {
                    id: id, // mudar quando o login estiver pronto
                    nome: nome,
                    email: email,
                    senha: senha,
                    imagem: imagem,
                    tags: getSelectedOptions(),
                };

                alterUser(cadastro);
                $("#form-contato")[0].reset(    );
                displayMessage("Alterado!");
            });

            $("#btnClear").click(function () {
                deleteUser(id);
            });

            function displayMessage(message) {
                alert(message);
            }

        }

        function randomNumber() {
            //  gerar um numero de 1 a 99;
            let random = Math.floor(Math.random() * 100);;
            //  retornar
            return random;
        }

        function getSelectedOptions() {
            let options = [];
            if ($("#checkboxEnergetico").is(":checked")) {
                options.push($("#checkboxEnergetico").val());
            }
            if ($("#checkboxCarente").is(":checked")) {
                options.push($("#checkboxCarente").val());
            }
            if ($("#checkboxOcupado").is(":checked")) {
                options.push($("#checkboxOcupado").val());
            }
            return options;
        }

        async function loadProfileData(id) {
            /*const profile = {
                "id": "1",
                "nome": "Leanne Graham",
                "email": "Sincere@april.biz",
                "senha": "123",
                "imagem": "https://th.bing.com/th/id/OIP.zhocY561T6tV46IluUCUhwHaE8?rs=1&pid=ImgDetMain"
            };*/
            const profile = await readUser(id);

            $("#inputNome").attr("placeholder", profile.nome);
            $("#inputEmail").attr("placeholder", profile.email);
            $("#imagemPerfil").attr("src", profile.imagem);
            $("#inputSenha").attr("placeholder", profile.senha);
        }
    </script>
</body>